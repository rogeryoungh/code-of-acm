<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>卷积 on Roger Young</title>
    <link>https://rogeryoungh.github.io/code-of-acm/tags/%E5%8D%B7%E7%A7%AF/</link>
    <description>Recent content in 卷积 on Roger Young</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh</language>
    <copyright>© 2021 [Roger Young](/code-of-acm)</copyright>
    <lastBuildDate>Wed, 28 Jul 2021 00:00:00 +0000</lastBuildDate><atom:link href="https://rogeryoungh.github.io/code-of-acm/tags/%E5%8D%B7%E7%A7%AF/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>P4173 残缺的字符串</title>
      <link>https://rogeryoungh.github.io/code-of-acm/post/2021-07/p4173/</link>
      <pubDate>Wed, 28 Jul 2021 00:00:00 +0000</pubDate>
      
      <guid>https://rogeryoungh.github.io/code-of-acm/post/2021-07/p4173/</guid>
      <description>魔改 KMP 大概是不行的，卷积在这里出现的很妙。
卷积处理匹配 定义匹配函数
$$ d(x,y) = [x = y] $$
给定文本串 $B$ 和长为 $m$ 的模式串 $A$，要找出 $A$ 在 $B$ 的所有出现，可以定义
$$ f(k) = \sum_{i=0}^{m-1} d(A_{i}, B_{i-m+k}) $$
即 $f(k) = 0$ 时有完全匹配 $A = B[k-m\ldots k-1]$。考虑让 $d$ 函数更 “数学” 一点，以更好的计算
$$ d(x,y) = (x - y)^2 $$
再提供模式串 $A$ 的翻转 $S$，即 $A_i = S_{m-i}$，展开有
$$ \begin{aligned} f(k) &amp;amp;= \sum_{i=0}^{m-1}A_{i}^2 + \sum_{i=0}^{m-1}B_{i-m+k}^2 - 2\sum_{i=0}^{m-1} A_{i}B_{i-m+k}\ &amp;amp;= \sum_{i=0}^{m-1}A_{i}^2 + \sum_{i=0}^{m-1}B_{i-m+k}^2 - 2\sum_{i=0}^{m-1} S_{m-i}B_{i-m+k} \end{aligned} $$</description>
    </item>
    
  </channel>
</rss>
