---
author: "rogeryoungh"
title: "P5171 Earthquake"
date: "2021-10-28"
katex: true
showtoc: true
---

## 题目大意

给定 $a,b,c$，求满足方程 $ax + by \leqslant c$ 的非负整数解的个数。

## 分析

令 $n = \lfloor c / a \rfloor$，容易推出让我们求的是


{{< display-math >}}
n + 1 + \sum_{x = 0}^{n} \left\lfloor \frac{c - ax}{b} \right\rfloor
{{< /display-math >}}

直接套类欧是不行的，因为系数有负数。其他题解感觉推麻烦了，直接考虑水平翻转，令 $x \to (n -  x)$，代入有

{{< display-math >}}
n + 1 + \sum_{x = 0}^{n} \left\lfloor \frac{ax + c - an}{b} \right\rfloor
{{< /display-math >}}

显然 $c - an$ 是 `c % a`，于是套类欧即可

```cpp
ll Euclid(ll a, ll b, ll c, ll n) {
    ll m = (a * n + b) / c, S1 = n * (n + 1) / 2;
    if (a == 0) {
        return b / c * (n + 1);
    } else if (a >= c || b >= c) {
        ll f = S1 * (a / c) + b / c * (n + 1);
        return f + Euclid(a % c, b % c, c, n);
    } else {
        return m * n - Euclid(c, c - b - 1, a, m - 1);
    }
}

int main() {
    ll a = rr(), b = rr(), c = rr();
    ll n = c / a;
    printf("%lld\n", Euclid(a, c % a, b, n) + n + 1);
    return 0;
}
```
