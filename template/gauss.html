<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Gauss 消元 | 算法笔记</title>
    <meta name="description" content="rogeryoungh 的算法笔记">
    <meta name="generator" content="VitePress v1.5.0">
    <link rel="preload stylesheet" href="/assets/style.9cYHD3xQ.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.DOgsbzse.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.CGuZdPmE.js">
    <link rel="modulepreload" href="/assets/chunks/framework.DPuwY6B9.js">
    <link rel="modulepreload" href="/assets/template_gauss.md.oYSaYlQD.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-20f38723><!--[--><!--]--><!--[--><span tabindex="-1" data-v-f72cd4cf></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-f72cd4cf> Skip to content </a><!--]--><!----><header class="VPNav" data-v-20f38723 data-v-858c82fa><div class="VPNavBar" data-v-858c82fa data-v-b8c3770f><div class="wrapper" data-v-b8c3770f><div class="container" data-v-b8c3770f><div class="title" data-v-b8c3770f><div class="VPNavBarTitle has-sidebar" data-v-b8c3770f data-v-98f44ef2><a class="title" href="/" data-v-98f44ef2><!--[--><!--]--><!----><span data-v-98f44ef2>算法笔记</span><!--[--><!--]--></a></div></div><div class="content" data-v-b8c3770f><div class="content-body" data-v-b8c3770f><!--[--><!--]--><div class="VPNavBarSearch search" data-v-b8c3770f><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-b8c3770f data-v-83f8c3f0><span id="main-nav-aria-label" class="visually-hidden" data-v-83f8c3f0> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-83f8c3f0 data-v-77bce7c1><!--[--><span data-v-77bce7c1>主页</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/template/" tabindex="0" data-v-83f8c3f0 data-v-77bce7c1><!--[--><span data-v-77bce7c1>模板</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/logs/" tabindex="0" data-v-83f8c3f0 data-v-77bce7c1><!--[--><span data-v-77bce7c1>日志</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-b8c3770f data-v-4db2e9ce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-4db2e9ce data-v-a1c36c4c data-v-bcd3212c><span class="check" data-v-bcd3212c><span class="icon" data-v-bcd3212c><!--[--><span class="vpi-sun sun" data-v-a1c36c4c></span><span class="vpi-moon moon" data-v-a1c36c4c></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-b8c3770f data-v-7f15e9ef data-v-bf2b29ae><!--[--><a class="VPSocialLink no-icon" href="https://github.com/rogeryoungh/code-of-acm" aria-label="github" target="_blank" rel="noopener" data-v-bf2b29ae data-v-8c7eb595><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-b8c3770f data-v-f9bc6ed4 data-v-ed60110b><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-ed60110b><span class="vpi-more-horizontal icon" data-v-ed60110b></span></button><div class="menu" data-v-ed60110b><div class="VPMenu" data-v-ed60110b data-v-faf343ae><!----><!--[--><!--[--><!----><div class="group" data-v-f9bc6ed4><div class="item appearance" data-v-f9bc6ed4><p class="label" data-v-f9bc6ed4>Appearance</p><div class="appearance-action" data-v-f9bc6ed4><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-f9bc6ed4 data-v-a1c36c4c data-v-bcd3212c><span class="check" data-v-bcd3212c><span class="icon" data-v-bcd3212c><!--[--><span class="vpi-sun sun" data-v-a1c36c4c></span><span class="vpi-moon moon" data-v-a1c36c4c></span><!--]--></span></span></button></div></div></div><div class="group" data-v-f9bc6ed4><div class="item social-links" data-v-f9bc6ed4><div class="VPSocialLinks social-links-list" data-v-f9bc6ed4 data-v-bf2b29ae><!--[--><a class="VPSocialLink no-icon" href="https://github.com/rogeryoungh/code-of-acm" aria-label="github" target="_blank" rel="noopener" data-v-bf2b29ae data-v-8c7eb595><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-b8c3770f data-v-d8db0fc1><span class="container" data-v-d8db0fc1><span class="top" data-v-d8db0fc1></span><span class="middle" data-v-d8db0fc1></span><span class="bottom" data-v-d8db0fc1></span></span></button></div></div></div></div><div class="divider" data-v-b8c3770f><div class="divider-line" data-v-b8c3770f></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-20f38723 data-v-1904986e><div class="container" data-v-1904986e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-1904986e><span class="vpi-align-left menu-icon" data-v-1904986e></span><span class="menu-text" data-v-1904986e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-1904986e data-v-f66d7fbe><button data-v-f66d7fbe>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-20f38723 data-v-07424431><div class="curtain" data-v-07424431></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-07424431><span class="visually-hidden" id="sidebar-aria-label" data-v-07424431> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-bc68f4f6><section class="VPSidebarItem level-0" data-v-bc68f4f6 data-v-9942fcb9><div class="item" role="button" tabindex="0" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><h2 class="text" data-v-9942fcb9>基础</h2><!----></div><div class="items" data-v-9942fcb9><!--[--><div class="VPSidebarItem level-1 is-link" data-v-9942fcb9 data-v-9942fcb9><div class="item" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><a class="VPLink link link" href="/template/" data-v-9942fcb9><!--[--><p class="text" data-v-9942fcb9>介绍</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-9942fcb9 data-v-9942fcb9><div class="item" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><a class="VPLink link link" href="/template/base" data-v-9942fcb9><!--[--><p class="text" data-v-9942fcb9>初始文件</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-9942fcb9 data-v-9942fcb9><div class="item" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><a class="VPLink link link" href="/template/vec2d" data-v-9942fcb9><!--[--><p class="text" data-v-9942fcb9>二维数组</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-9942fcb9 data-v-9942fcb9><div class="item" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><a class="VPLink link link" href="/template/qpow" data-v-9942fcb9><!--[--><p class="text" data-v-9942fcb9>快速幂</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-9942fcb9 data-v-9942fcb9><div class="item" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><a class="VPLink link link" href="/template/binary-search" data-v-9942fcb9><!--[--><p class="text" data-v-9942fcb9>二分查找</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-9942fcb9 data-v-9942fcb9><div class="item" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><a class="VPLink link link" href="/template/modint" data-v-9942fcb9><!--[--><p class="text" data-v-9942fcb9>modint</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-bc68f4f6><section class="VPSidebarItem level-0" data-v-bc68f4f6 data-v-9942fcb9><div class="item" role="button" tabindex="0" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><h2 class="text" data-v-9942fcb9>数据结构</h2><!----></div><div class="items" data-v-9942fcb9><!--[--><div class="VPSidebarItem level-1 is-link" data-v-9942fcb9 data-v-9942fcb9><div class="item" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><a class="VPLink link link" href="/template/dsu" data-v-9942fcb9><!--[--><p class="text" data-v-9942fcb9>并查集</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-9942fcb9 data-v-9942fcb9><div class="item" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><a class="VPLink link link" href="/template/sparse-table" data-v-9942fcb9><!--[--><p class="text" data-v-9942fcb9>Sparse Table</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-9942fcb9 data-v-9942fcb9><div class="item" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><a class="VPLink link link" href="/template/fwtree" data-v-9942fcb9><!--[--><p class="text" data-v-9942fcb9>树状数组</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-bc68f4f6><section class="VPSidebarItem level-0 has-active" data-v-bc68f4f6 data-v-9942fcb9><div class="item" role="button" tabindex="0" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><h2 class="text" data-v-9942fcb9>数学</h2><!----></div><div class="items" data-v-9942fcb9><!--[--><div class="VPSidebarItem level-1 is-link" data-v-9942fcb9 data-v-9942fcb9><div class="item" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><a class="VPLink link link" href="/template/matrix" data-v-9942fcb9><!--[--><p class="text" data-v-9942fcb9>矩阵</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-9942fcb9 data-v-9942fcb9><div class="item" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><a class="VPLink link link" href="/template/gauss" data-v-9942fcb9><!--[--><p class="text" data-v-9942fcb9>Gauss 消元</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-9942fcb9 data-v-9942fcb9><div class="item" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><a class="VPLink link link" href="/template/exgcd" data-v-9942fcb9><!--[--><p class="text" data-v-9942fcb9>EXGCD</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-9942fcb9 data-v-9942fcb9><div class="item" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><a class="VPLink link link" href="/template/sieve" data-v-9942fcb9><!--[--><p class="text" data-v-9942fcb9>筛法</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-9942fcb9 data-v-9942fcb9><div class="item" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><a class="VPLink link link" href="/template/primality-test" data-v-9942fcb9><!--[--><p class="text" data-v-9942fcb9>素性测试</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-9942fcb9 data-v-9942fcb9><div class="item" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><a class="VPLink link link" href="/template/factor" data-v-9942fcb9><!--[--><p class="text" data-v-9942fcb9>质因分解</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-9942fcb9 data-v-9942fcb9><div class="item" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><a class="VPLink link link" href="/template/crt" data-v-9942fcb9><!--[--><p class="text" data-v-9942fcb9>中国剩余定理</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-9942fcb9 data-v-9942fcb9><div class="item" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><a class="VPLink link link" href="/template/floor-sum" data-v-9942fcb9><!--[--><p class="text" data-v-9942fcb9>Floor Sum</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-9942fcb9 data-v-9942fcb9><div class="item" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><a class="VPLink link link" href="/template/quad-residue" data-v-9942fcb9><!--[--><p class="text" data-v-9942fcb9>二次剩余</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-bc68f4f6><section class="VPSidebarItem level-0" data-v-bc68f4f6 data-v-9942fcb9><div class="item" role="button" tabindex="0" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><h2 class="text" data-v-9942fcb9>字符串</h2><!----></div><div class="items" data-v-9942fcb9><!--[--><div class="VPSidebarItem level-1 is-link" data-v-9942fcb9 data-v-9942fcb9><div class="item" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><a class="VPLink link link" href="/template/kmp" data-v-9942fcb9><!--[--><p class="text" data-v-9942fcb9>KMP</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-9942fcb9 data-v-9942fcb9><div class="item" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><a class="VPLink link link" href="/template/z-algo" data-v-9942fcb9><!--[--><p class="text" data-v-9942fcb9>Z Algorithm</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-bc68f4f6><section class="VPSidebarItem level-0" data-v-bc68f4f6 data-v-9942fcb9><div class="item" role="button" tabindex="0" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><h2 class="text" data-v-9942fcb9>图论</h2><!----></div><div class="items" data-v-9942fcb9><!--[--><div class="VPSidebarItem level-1 is-link" data-v-9942fcb9 data-v-9942fcb9><div class="item" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><a class="VPLink link link" href="/template/shortest-path" data-v-9942fcb9><!--[--><p class="text" data-v-9942fcb9>最短路</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-9942fcb9 data-v-9942fcb9><div class="item" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><a class="VPLink link link" href="/template/mst" data-v-9942fcb9><!--[--><p class="text" data-v-9942fcb9>最小生成树</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-bc68f4f6><section class="VPSidebarItem level-0" data-v-bc68f4f6 data-v-9942fcb9><div class="item" role="button" tabindex="0" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><h2 class="text" data-v-9942fcb9>无用</h2><!----></div><div class="items" data-v-9942fcb9><!--[--><div class="VPSidebarItem level-1 is-link" data-v-9942fcb9 data-v-9942fcb9><div class="item" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><a class="VPLink link link" href="/template/some-trick" data-v-9942fcb9><!--[--><p class="text" data-v-9942fcb9>小技巧</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-9942fcb9 data-v-9942fcb9><div class="item" data-v-9942fcb9><div class="indicator" data-v-9942fcb9></div><a class="VPLink link link" href="/template/fastio" data-v-9942fcb9><!--[--><p class="text" data-v-9942fcb9>快读</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-20f38723 data-v-2b9b85a1><div class="VPDoc has-sidebar has-aside" data-v-2b9b85a1 data-v-1711b555><!--[--><!--]--><div class="container" data-v-1711b555><div class="aside" data-v-1711b555><div class="aside-curtain" data-v-1711b555></div><div class="aside-container" data-v-1711b555><div class="aside-content" data-v-1711b555><div class="VPDocAside" data-v-1711b555 data-v-5e680220><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-5e680220 data-v-10a1234a><div class="content" data-v-10a1234a><div class="outline-marker" data-v-10a1234a></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-10a1234a>On this page</div><ul class="VPDocOutlineItem root" data-v-10a1234a data-v-dfdc0c91><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-5e680220></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-1711b555><div class="content-container" data-v-1711b555><!--[--><!--]--><main class="main" data-v-1711b555><div style="position:relative;" class="vp-doc _template_gauss" data-v-1711b555><div><h1 id="gauss-消元" tabindex="-1">Gauss 消元 <a class="header-anchor" href="#gauss-消元" aria-label="Permalink to &quot;Gauss 消元&quot;">​</a></h1><h2 id="gauss-消元・" tabindex="-1">Gauss 消元・<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:0;" xmlns="http://www.w3.org/2000/svg" width="1.633ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 722 683" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="211D" d="M17 665Q17 672 28 683H221Q415 681 439 677Q461 673 481 667T516 654T544 639T566 623T584 607T597 592T607 578T614 565T618 554L621 548Q626 530 626 497Q626 447 613 419Q578 348 473 326L455 321Q462 310 473 292T517 226T578 141T637 72T686 35Q705 30 705 16Q705 7 693 -1H510Q503 6 404 159L306 310H268V183Q270 67 271 59Q274 42 291 38Q295 37 319 35Q344 35 353 28Q362 17 353 3L346 -1H28Q16 5 16 16Q16 35 55 35Q96 38 101 52Q106 60 106 341T101 632Q95 645 55 648Q17 648 17 665ZM241 35Q238 42 237 45T235 78T233 163T233 337V621L237 635L244 648H133Q136 641 137 638T139 603T141 517T141 341Q141 131 140 89T134 37Q133 36 133 35H241ZM457 496Q457 540 449 570T425 615T400 634T377 643Q374 643 339 648Q300 648 281 635Q271 628 270 610T268 481V346H284Q327 346 375 352Q421 364 439 392T457 496ZM492 537T492 496T488 427T478 389T469 371T464 361Q464 360 465 360Q469 360 497 370Q593 400 593 495Q593 592 477 630L457 637L461 626Q474 611 488 561Q492 537 492 496ZM464 243Q411 317 410 317Q404 317 401 315Q384 315 370 312H346L526 35H619L606 50Q553 109 464 243Z" style="stroke-width:3;"></path></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow data-mjx-texclass="ORD"><mi mathvariant="double-struck">R</mi></mrow></math></mjx-assistive-mml></mjx-container> <a class="header-anchor" href="#gauss-消元・" aria-label="Permalink to &quot;Gauss 消元・$\mathbb{R}$&quot;">​</a></h2><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vec2d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">f64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">gauss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vec2d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">f64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">f64</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> eps</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">E-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v.x; i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v.x; j</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">			if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">abs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(v[j][i]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">abs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(v[mi][i]))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">				mi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v.y; j</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">			std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(v[i][j], v[mi][j]);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">abs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(v[i][i]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> eps)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">			return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::nullopt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		auto</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ivi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v[i][i];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v.y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i; k</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">			v[i][k] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ivi;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v.x; j</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">			if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">				auto</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tmp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v[j][i];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">				for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v.y; k</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">					v[j][k] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v[i][k] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tmp;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">			}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="gauss-消元・-1" tabindex="-1">Gauss 消元・<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.65ex;" xmlns="http://www.w3.org/2000/svg" width="2.502ex" height="2.195ex" role="img" focusable="false" viewBox="0 -683 1105.7 970.2" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="2124" d="M39 -1Q29 9 29 12Q29 23 60 77T219 337L410 648H364Q261 648 210 628Q168 612 142 588T109 545T97 509T88 490Q85 489 80 489Q72 489 61 503L70 588Q72 607 75 628T79 662T81 675Q84 677 88 681Q90 683 341 683H592Q604 673 604 666Q604 662 412 348L221 37Q221 35 301 35Q406 35 446 48Q504 68 543 111T597 212Q602 239 617 239Q624 239 629 234T635 223Q635 215 621 113T604 8L597 1Q595 -1 317 -1H39ZM148 637L166 648H112V632Q111 629 110 622T108 612Q108 608 110 608T116 612T129 623T148 637ZM552 646Q552 648 504 648Q452 648 450 643Q448 639 266 343T77 37Q77 35 128 35H179L366 339L552 646ZM572 35Q581 89 581 97L561 77Q542 59 526 48L508 37L539 35H572Z" style="stroke-width:3;"></path></g></g><g data-mml-node="mi" transform="translate(700,-150) scale(0.707)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z" style="stroke-width:3;"></path></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow data-mjx-texclass="ORD"><mi mathvariant="double-struck">Z</mi></mrow><mi>p</mi></msub></math></mjx-assistive-mml></mjx-container> <a class="header-anchor" href="#gauss-消元・-1" aria-label="Permalink to &quot;Gauss 消元・$\mathbb{Z}_p$&quot;">​</a></h2><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Z</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vec2d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Z</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">gauss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vec2d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Z</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v.x; i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v.x; j</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">			if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (v[j][i].v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">				mi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v.y; j</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">			std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(v[i][j], v[mi][j]);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (v[i][i].v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">			return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::nullopt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		auto</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ivi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v[i][i].</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">inv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v.y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i; k</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">			v[i][k] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ivi;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v.x; j</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">			if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">				auto</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tmp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v[j][i];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">				for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v.y; k</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">					v[j][k] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v[i][k] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tmp;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">			}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></div></div></main><footer class="VPDocFooter" data-v-1711b555 data-v-68a6428b><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-68a6428b><span class="visually-hidden" id="doc-footer-aria-label" data-v-68a6428b>Pager</span><div class="pager" data-v-68a6428b><a class="VPLink link pager-link prev" href="/template/matrix" data-v-68a6428b><!--[--><span class="desc" data-v-68a6428b>Previous page</span><span class="title" data-v-68a6428b>矩阵</span><!--]--></a></div><div class="pager" data-v-68a6428b><a class="VPLink link pager-link next" href="/template/exgcd" data-v-68a6428b><!--[--><span class="desc" data-v-68a6428b>Next page</span><span class="title" data-v-68a6428b>EXGCD</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"index.md\":\"BZSOc-f1\",\"logs_2020-09.md\":\"DCDZ3si3\",\"logs_2020-10.md\":\"B5OrTJwt\",\"logs_2020-11.md\":\"SvtfYS0D\",\"logs_2020-12.md\":\"ESOhtIxh\",\"logs_2021-01.md\":\"9Flpf0cC\",\"logs_2021-02.md\":\"DjVH0OCF\",\"logs_2021-03.md\":\"BwaLnPLj\",\"logs_2021-04.md\":\"Bpz088vZ\",\"logs_2021-05.md\":\"Bn0f13Jv\",\"logs_2022-01.md\":\"CSwyu8EB\",\"logs_2024-11.md\":\"CT6CB2Vm\",\"logs_index.md\":\"C8LlTECE\",\"template_base.md\":\"CWevcW_u\",\"template_binary-search.md\":\"CzxWK7IM\",\"template_crt.md\":\"Bx3PnSr8\",\"template_dsu.md\":\"BdO_uvIP\",\"template_exgcd.md\":\"CNixhy2Q\",\"template_factor.md\":\"cS0gjlt4\",\"template_fastio.md\":\"DjZrzKFL\",\"template_floor-sum.md\":\"B5Lqad0K\",\"template_fwtree.md\":\"Cwd9rmQA\",\"template_gauss.md\":\"oYSaYlQD\",\"template_index.md\":\"C0O1U5Ti\",\"template_kmp.md\":\"DtjUMnXx\",\"template_matrix.md\":\"B-fqRHek\",\"template_modint.md\":\"CKZytGny\",\"template_mst.md\":\"CuUP25Z2\",\"template_primality-test.md\":\"Ma4iy6c7\",\"template_qpow.md\":\"BDi_VQcd\",\"template_quad-residue.md\":\"BKjbZG28\",\"template_shortest-path.md\":\"DSjQe7m7\",\"template_sieve.md\":\"DXc_ULi9\",\"template_some-trick.md\":\"Cvujy1X9\",\"template_sparse-table.md\":\"CzUiXF9M\",\"template_vec2d.md\":\"Bg_uFOcE\",\"template_z-algo.md\":\"B4qhL0La\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"算法笔记\",\"description\":\"rogeryoungh 的算法笔记\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"主页\",\"link\":\"/\"},{\"text\":\"模板\",\"link\":\"/template/\"},{\"text\":\"日志\",\"link\":\"/logs/\"}],\"sidebar\":{\"/logs/\":[{\"text\":\"2020\",\"items\":[{\"text\":\"2020-09\",\"link\":\"/logs/2020-09\"},{\"text\":\"2020-10\",\"link\":\"/logs/2020-10\"},{\"text\":\"2020-11\",\"link\":\"/logs/2020-11\"},{\"text\":\"2020-12\",\"link\":\"/logs/2020-12\"}]},{\"text\":\"2021\",\"items\":[{\"text\":\"2021-01\",\"link\":\"/logs/2021-01\"},{\"text\":\"2021-02\",\"link\":\"/logs/2021-02\"},{\"text\":\"2021-03\",\"link\":\"/logs/2021-03\"},{\"text\":\"2021-04\",\"link\":\"/logs/2021-04\"},{\"text\":\"2021-05\",\"link\":\"/logs/2021-05\"}]},{\"text\":\"2022\",\"items\":[{\"text\":\"2022-01\",\"link\":\"/logs/2022-01\"}]},{\"text\":\"2024\",\"items\":[{\"text\":\"2024-11\",\"link\":\"/logs/2024-11\"}]}],\"/template/\":[{\"text\":\"基础\",\"items\":[{\"text\":\"介绍\",\"link\":\"/template/\"},{\"text\":\"初始文件\",\"link\":\"/template/base\"},{\"text\":\"二维数组\",\"link\":\"/template/vec2d\"},{\"text\":\"快速幂\",\"link\":\"/template/qpow\"},{\"text\":\"二分查找\",\"link\":\"/template/binary-search\"},{\"text\":\"modint\",\"link\":\"/template/modint\"}]},{\"text\":\"数据结构\",\"items\":[{\"text\":\"并查集\",\"link\":\"/template/dsu\"},{\"text\":\"Sparse Table\",\"link\":\"/template/sparse-table\"},{\"text\":\"树状数组\",\"link\":\"/template/fwtree\"}]},{\"text\":\"数学\",\"items\":[{\"text\":\"矩阵\",\"link\":\"/template/matrix\"},{\"text\":\"Gauss 消元\",\"link\":\"/template/gauss\"},{\"text\":\"EXGCD\",\"link\":\"/template/exgcd\"},{\"text\":\"筛法\",\"link\":\"/template/sieve\"},{\"text\":\"素性测试\",\"link\":\"/template/primality-test\"},{\"text\":\"质因分解\",\"link\":\"/template/factor\"},{\"text\":\"中国剩余定理\",\"link\":\"/template/crt\"},{\"text\":\"Floor Sum\",\"link\":\"/template/floor-sum\"},{\"text\":\"二次剩余\",\"link\":\"/template/quad-residue\"}]},{\"text\":\"字符串\",\"items\":[{\"text\":\"KMP\",\"link\":\"/template/kmp\"},{\"text\":\"Z Algorithm\",\"link\":\"/template/z-algo\"}]},{\"text\":\"图论\",\"items\":[{\"text\":\"最短路\",\"link\":\"/template/shortest-path\"},{\"text\":\"最小生成树\",\"link\":\"/template/mst\"}]},{\"text\":\"无用\",\"items\":[{\"text\":\"小技巧\",\"link\":\"/template/some-trick\"},{\"text\":\"快读\",\"link\":\"/template/fastio\"}]}]},\"search\":{\"provider\":\"local\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/rogeryoungh/code-of-acm\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>